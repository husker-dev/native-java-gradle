buildscript {
    repositories {
        jcenter()
    }
    dependencies {
        classpath 'de.undercouch:gradle-download-task:4.1.1'
    }
}

plugins {
    id 'java-gradle-plugin'
    id 'groovy'
    id 'maven-publish'
    id 'com.gradle.plugin-publish' version '0.14.0'
}

/*
def thisPlugin = new GroovyScriptEngine(file('src/main/groovy').absolutePath, this.class.classLoader)
                .loadScriptByName('com/husker/gradle/ncompile/NativeCompilePlugin.groovy')

apply plugin: thisPlugin

 */
apply plugin: 'de.undercouch.download'

repositories {
    mavenCentral()
}

dependencies {
    implementation gradleApi()
    implementation localGroovy()
    testImplementation('org.spockframework:spock-core:1.3-groovy-2.5') {
        exclude group: 'org.codehaus.groovy'
    }
}

pluginBundle {
    website = 'https://github.com/husker-dev/native-java-gradle'
    vcsUrl = 'https://github.com/husker-dev/native-java-gradle'
    tags = ['java', 'native', 'graal', 'graalvm', 'compile', 'compilation']
}

group 'com.husker.native'
version = '1.0'

gradlePlugin {
    plugins {
        ncompile {
            id = 'com.husker.native'
            displayName = 'Java native compile'
            description = "Native Java compilation using GraalVM"
            implementationClass = 'com.husker.gradle.ncompile.NativeCompilePlugin'
        }
    }
}

